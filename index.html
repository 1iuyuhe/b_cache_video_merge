<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ÂìîÂì©ÂìîÂì©Ôºàbilibili.com)ÊòØÂõΩÂÜÖÁü•ÂêçÁöÑËßÜÈ¢ëÂºπÂπïÁΩëÁ´ôÔºåËøôÈáåÊúâÂèäÊó∂ÁöÑÂä®Êº´Êñ∞Áï™ÔºåÊ¥ªË∑ÉÁöÑACGÊ∞õÂõ¥ÔºåÊúâÂàõÊÑèÁöÑUp‰∏ª„ÄÇÂ§ßÂÆ∂ÂèØ‰ª•Âú®ËøôÈáåÊâæÂà∞ËÆ∏Â§öÊ¨¢‰πê„ÄÇ">
    <meta name="keywords" content="Bilibili,ÂìîÂì©ÂìîÂì©,ÂìîÂì©ÂìîÂì©Âä®Áîª,ÂìîÂì©ÂìîÂì©ÂºπÂπïÁΩë,ÂºπÂπïËßÜÈ¢ë,BÁ´ô,ÂºπÂπï,Â≠óÂπï,AMV,MAD,MTV,ANIME,Âä®Êº´,Âä®Êº´Èü≥‰πê,Ê∏∏Êàè,Ê∏∏ÊàèËß£ËØ¥,‰∫åÊ¨°ÂÖÉ,Ê∏∏ÊàèËßÜÈ¢ë,ACG,galgame,Âä®Áîª,Áï™ÁªÑ,Êñ∞Áï™,ÂàùÈü≥,Ê¥õÂ§©‰æù,vocaloid,Êó•Êú¨Âä®Êº´,ÂõΩ‰∫ßÂä®Êº´,ÊâãÊú∫Ê∏∏Êàè,ÁΩëÁªúÊ∏∏Êàè,ÁîµÂ≠êÁ´ûÊäÄ,ACGÁáÉÊõ≤,ACGÁ•ûÊõ≤,ËøΩÊñ∞Áï™,Êñ∞Áï™Âä®Êº´,Êñ∞Áï™ÂêêÊßΩ,Â∑°Èü≥,ÈïúÈü≥ÂèåÂ≠ê,ÂçÉÊú¨Ê®±,ÂàùÈü≥MIKU,ËàûËπàMMD,MIKUMIKUDANCE,Ê¥õÂ§©‰æùÂéüÂàõÊõ≤,Ê¥õÂ§©‰æùÁøªÂî±Êõ≤,Ê¥õÂ§©‰æùÊäïÈ£üÊ≠å,Ê¥õÂ§©‰æùMMD,vocaloidÂÆ∂Êóè,OST,BGM,Âä®Êº´Ê≠åÊõ≤,Êó•Êú¨Âä®Êº´Èü≥‰πê,ÂÆ´Â¥éÈ™èÂä®Êº´Èü≥‰πê,Âä®Êº´Èü≥‰πêÊé®Ëçê,ÁáÉÁ≥ªmad,Ê≤ªÊÑàÁ≥ªmad,MAD MOVIE,MADÈ´òÁáÉ">
    <title>ÂìîÂì©ÂìîÂì© („Çú-„Çú)„Å§„É≠ Âπ≤ÊùØ~-bilibili</title>
    <link rel="shortcut icon" href="./assets/favicon.ico">
</head>
<body>
    <label for="video-uploader">ËßÜÈ¢ë: </label>
    <input type="file" id="video-uploader" name="video" accept="video/m4s" >
    <label for="audio-uploader">Èü≥È¢ë: </label>
    <input type="file" id="audio-uploader" name="audio" accept="audio/m4s" >
    <button id="merge-button">ÂêàÂπ∂</button>
    <div id="log" style="width: 100%; background-color: #fff;"></div>
    <script>
        console.log = (function(logFunc) {
        return function() {
            const logDiv = document.getElementById("log");
            for (let i = 0; i < arguments.length; i++) {
                logDiv.innerText = `${logDiv.innerText}\nüòò ${arguments[i]}`;
            }
            window.scrollTo(0, document.body.scrollHeight);
            logFunc.call(console, 'üòò', ...arguments);
        }
        })(console.log)
    </script>
    <script src="./node_modules/@ffmpeg/ffmpeg/dist/ffmpeg.min.js"></script>
    <script>
        const { createFFmpeg, fetchFile } = FFmpeg;
        const ffmpeg = createFFmpeg({
            log: true
        });
        const merge = async () => {
            const videoUploader = document.getElementById("video-uploader");
            const audioUploader = document.getElementById("audio-uploader");
            let video = videoUploader.files;
            let audio = audioUploader.files;
            if (video.length === 0 || audio.length === 0) {
                alert('Èü≥ËßÜÈ¢ëÊñá‰ª∂‰∏çËÉΩ‰∏∫Á©∫!');
                return;
            }
            video = video[0];
            audio = audio[0];
            const videoName = video.name;
            const audioName = audio.name;
            if (!ffmpeg.isLoaded()) {
                await ffmpeg.load();
            }
            const dataInputVideo = await fetchFile(video);
            const dataInputAudio = await fetchFile(audio);
            ffmpeg.FS('writeFile', videoName, dataInputVideo);
            ffmpeg.FS('writeFile', audioName, dataInputAudio);
            await ffmpeg.run('-i', videoName, '-i', audioName, '-c:v', 'copy', '-c:a', 'aac', '-strict', 'experimental', '-map', '0:v:0', '-map', '1:a:0', 'output.mp4');
            const data = ffmpeg.FS('readFile', 'output.mp4');
            // ‰∏ãËΩΩ
            const downloadUrl = URL.createObjectURL(new Blob([data.buffer], {type: "video/mp4"}));
            const saveA = document.createElement("a");
            document.body.appendChild(saveA);
            saveA.href = downloadUrl;
            saveA.download = "video" + (new Date()).getTime();
            saveA.target = "_blank";
            saveA.click();
        }
        document.getElementById("merge-button").addEventListener("click", merge);
    </script>
</body>
</html>